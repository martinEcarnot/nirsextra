sp=asd_read(l[i])
library(nirsextra)
# x[i,]=get_spectra(l[i], type = "reflectance")
sp=asd_read(l[i])
t1=paste(sp$info$spectrumheaderwhensec,sp$info$spectrumheaderwhenmin,sp$info$spectrumheaderwhenhour,sp$info$spectrumheaderwhenmday,sp$info$spectrumheaderwhenmon,sp$info$spectrumheaderwhenyear)
tim=rbind(tim,as.POSIXct(t1, format = "%S %M %H %d %m %Y"))
t1
t <- as.POSIXct(t1, format = "%S %M %H %d %m %Y")
t
tim=as.POSIXct()
t
for (i in 1:length(l)) {
# x[i,]=get_spectra(l[i], type = "reflectance")
sp=asd_read(l[i])
if (type=="l") {
x[i,]=sp$spectrum
} else if(type=="ref") {
x[i,]=sp$reference
} else {
x[i,]=sp$spectrum/sp$reference
}
# x[i,]=sp$spectrum
if (times) {
t1=paste(sp$info$spectrumheaderwhensec,sp$info$spectrumheaderwhenmin,sp$info$spectrumheaderwhenhour,sp$info$spectrumheaderwhenmday,sp$info$spectrumheaderwhenmon,sp$info$spectrumheaderwhenyear)
# tim=rbind(tim,as.POSIXct(t1, format = "%S %M %H %d %m %Y"))
tim=rbind(tim,t1)
}
if (comments) {com=rbind(com,sp$info$spectrumheadercomments)}
}
type=NULL
for (i in 1:length(l)) {
# x[i,]=get_spectra(l[i], type = "reflectance")
sp=asd_read(l[i])
if (type=="l") {
x[i,]=sp$spectrum
} else if(type=="ref") {
x[i,]=sp$reference
} else {
x[i,]=sp$spectrum/sp$reference
}
# x[i,]=sp$spectrum
if (times) {
t1=paste(sp$info$spectrumheaderwhensec,sp$info$spectrumheaderwhenmin,sp$info$spectrumheaderwhenhour,sp$info$spectrumheaderwhenmday,sp$info$spectrumheaderwhenmon,sp$info$spectrumheaderwhenyear)
# tim=rbind(tim,as.POSIXct(t1, format = "%S %M %H %d %m %Y"))
tim=rbind(tim,t1)
}
if (comments) {com=rbind(com,sp$info$spectrumheadercomments)}
}
l=Sys.glob(file.path(d,"*.asd"))
x=matrix(, nrow = length(l), ncol = 2151)
tim=""
com=NULL
for (i in 1:length(l)) {
# x[i,]=get_spectra(l[i], type = "reflectance")
sp=asd_read(l[i])
if (type=="l") {
x[i,]=sp$spectrum
} else if(type=="ref") {
x[i,]=sp$reference
} else {
x[i,]=sp$spectrum/sp$reference
}
# x[i,]=sp$spectrum
if (times) {
t1=paste(sp$info$spectrumheaderwhensec,sp$info$spectrumheaderwhenmin,sp$info$spectrumheaderwhenhour,sp$info$spectrumheaderwhenmday,sp$info$spectrumheaderwhenmon,sp$info$spectrumheaderwhenyear)
# tim=rbind(tim,as.POSIXct(t1, format = "%S %M %H %d %m %Y"))
tim=rbind(tim,t1)
}
if (comments) {com=rbind(com,sp$info$spectrumheadercomments)}
}
type=F
for (i in 1:length(l)) {
# x[i,]=get_spectra(l[i], type = "reflectance")
sp=asd_read(l[i])
if (type=="l") {
x[i,]=sp$spectrum
} else if(type=="ref") {
x[i,]=sp$reference
} else {
x[i,]=sp$spectrum/sp$reference
}
# x[i,]=sp$spectrum
if (times) {
t1=paste(sp$info$spectrumheaderwhensec,sp$info$spectrumheaderwhenmin,sp$info$spectrumheaderwhenhour,sp$info$spectrumheaderwhenmday,sp$info$spectrumheaderwhenmon,sp$info$spectrumheaderwhenyear)
# tim=rbind(tim,as.POSIXct(t1, format = "%S %M %H %d %m %Y"))
tim=rbind(tim,t1)
}
if (comments) {com=rbind(com,sp$info$spectrumheadercomments)}
}
times=TRUE
for (i in 1:length(l)) {
# x[i,]=get_spectra(l[i], type = "reflectance")
sp=asd_read(l[i])
if (type=="l") {
x[i,]=sp$spectrum
} else if(type=="ref") {
x[i,]=sp$reference
} else {
x[i,]=sp$spectrum/sp$reference
}
# x[i,]=sp$spectrum
if (times) {
t1=paste(sp$info$spectrumheaderwhensec,sp$info$spectrumheaderwhenmin,sp$info$spectrumheaderwhenhour,sp$info$spectrumheaderwhenmday,sp$info$spectrumheaderwhenmon,sp$info$spectrumheaderwhenyear)
# tim=rbind(tim,as.POSIXct(t1, format = "%S %M %H %d %m %Y"))
tim=rbind(tim,t1)
}
if (comments) {com=rbind(com,sp$info$spectrumheadercomments)}
}
comments=FALSE
for (i in 1:length(l)) {
# x[i,]=get_spectra(l[i], type = "reflectance")
sp=asd_read(l[i])
if (type=="l") {
x[i,]=sp$spectrum
} else if(type=="ref") {
x[i,]=sp$reference
} else {
x[i,]=sp$spectrum/sp$reference
}
# x[i,]=sp$spectrum
if (times) {
t1=paste(sp$info$spectrumheaderwhensec,sp$info$spectrumheaderwhenmin,sp$info$spectrumheaderwhenhour,sp$info$spectrumheaderwhenmday,sp$info$spectrumheaderwhenmon,sp$info$spectrumheaderwhenyear)
# tim=rbind(tim,as.POSIXct(t1, format = "%S %M %H %d %m %Y"))
tim=rbind(tim,t1)
}
if (comments) {com=rbind(com,sp$info$spectrumheadercomments)}
}
tim
as.POSIXct(tim, format = "%S %M %H %d %m %Y")
l=Sys.glob(file.path(d,"*.asd"))
x=matrix(, nrow = length(l), ncol = 2151)
tim=""
com=NULL
for (i in 1:length(l)) {
# x[i,]=get_spectra(l[i], type = "reflectance")
sp=asd_read(l[i])
if (type=="l") {
x[i,]=sp$spectrum
} else if(type=="ref") {
x[i,]=sp$reference
} else {
x[i,]=sp$spectrum/sp$reference
}
# x[i,]=sp$spectrum
if (times) {
t1=paste(sp$info$spectrumheaderwhensec,sp$info$spectrumheaderwhenmin,sp$info$spectrumheaderwhenhour,sp$info$spectrumheaderwhenmday,sp$info$spectrumheaderwhenmon,sp$info$spectrumheaderwhenyear)
tim=rbind(tim,as.POSIXct(t1, format = "%S %M %H %d %m %Y"))
# tim=rbind(tim,t1)
}
if (comments) {com=rbind(com,sp$info$spectrumheadercomments)}
}
tim
l=Sys.glob(file.path(d,"*.asd"))
x=matrix(, nrow = length(l), ncol = 2151)
tim=""
com=NULL
for (i in 1:length(l)) {
# x[i,]=get_spectra(l[i], type = "reflectance")
sp=asd_read(l[i])
if (type=="l") {
x[i,]=sp$spectrum
} else if(type=="ref") {
x[i,]=sp$reference
} else {
x[i,]=sp$spectrum/sp$reference
}
# x[i,]=sp$spectrum
if (times) {
t1=paste(sp$info$spectrumheaderwhensec,sp$info$spectrumheaderwhenmin,sp$info$spectrumheaderwhenhour,sp$info$spectrumheaderwhenmday,sp$info$spectrumheaderwhenmon,sp$info$spectrumheaderwhenyear)
# tim=rbind(tim,as.POSIXct(t1, format = "%S %M %H %d %m %Y"))
tim=rbind(tim,t1)
}
if (comments) {com=rbind(com,sp$info$spectrumheadercomments)}
}
# if (times) {attr(x,"time")=tim[-1]}
if (times) {attr(x,"time")=as.POSIXct(tim[-1], format = "%S %M %H %d %m %Y")}
row.names(x)=gsub(".asd","",basename(l))
colnames(x)=seq(from=sp$info$spectrumheaderch1_wavel,length.out=sp$info$spectrumheaderwchannels, by=sp$info$spectrumheaderwavel_step)
str(x)
devtools::document()
devtools::install()
ls("package:nirsextra")
devtools::document()
ls("package:nirsextra")
ls("package:nirsextra")
devtools::document()
unlink("NAMESPACE")
devtools::document()
devtools::document()
library(nirsextra)
library(rchemo)
load("/home/ecarnot/Documents/INRA/Projets/scoop/sp_SLA")
sp=sp[which(sp$SLA<2000),]
w=21
p=rbind(list('adj',''),list('red',c(50,20,1)),list('snv',''),list('sder',c(1,4,w)))
sp$xp=pre(sp$x,p)
# segm <- segmkf(n = nrow(sp), K = 5)
segm <- list(rep1 = as.list(1:nrow(sp)))
source("~/Documents/INRA/R/nirsextra/R/gridcv_mec.R", echo = TRUE)
# segm <- segmkf(n = nrow(sp), K = 5)
segm <- list(rep1 = as.list(1:nrow(sp)))
fmc = gcvlv(snv(sp$xp), sp$SLA,segm,score = r2, fun = plskern, nlv = 1:ncomp, verb = F)
ncomp=15
fmc = gcvlv(snv(sp$xp), sp$SLA,segm,score = r2, fun = plskern, nlv = 1:ncomp, verb = F)
str(zres)
hist(sp$SLA)
?r2
?cor2
source("~/Documents/INRA/R/nirsextra/R/gridscore_mec.R", echo = TRUE)
fmc = gcvlv(snv(sp$xp), sp$SLA,segm,score = r2, fun = plskern, nlv = 1:ncomp, verb = F)
pred[[i]]
Y
segm <- segmkf(n = nrow(sp), K = 5)
fmc = gcvlv(snv(sp$xp), sp$SLA,segm,score = r2, fun = plskern, nlv = 1:ncomp, verb = F)
pred[[i]]
source("~/Documents/INRA/R/nirsextra/R/gridscore_mec.R", echo = TRUE)
fmc = gcvlv(snv(sp$xp), sp$SLA,segm,score = r2, fun = plskern, nlv = 1:ncomp, verb = F)
str(res)
res
str(X)
# segm <- segmkf(n = nrow(sp), K = 5)
segm <- list(rep1 = as.list(1:nrow(sp)))
fmc = gcvlv(snv(sp$xp), sp$SLA,segm,score = r2, fun = plskern, nlv = 1:ncomp, verb = F)
colnames(y) = c("nlv","rowname","yp","yref")
source("~/Documents/INRA/R/nirsextra/R/gridscore_mec.R", echo = TRUE)
fmc = gcvlv(snv(sp$xp), sp$SLA,segm,score = r2, fun = plskern, nlv = 1:ncomp, verb = F)
library(nirsextra)
library(rchemo)
fmc = gcvlv(snv(sp$xp), sp$SLA,segm,score = r2, fun = plskern, nlv = 1:ncomp, verb = F)
library(nirsextra)
library(rchemo)
load("/home/ecarnot/Documents/INRA/Projets/scoop/sp_SLA")
sp=sp[which(sp$SLA<2000),]
w=21
ncomp=15
p=rbind(list('adj',''),list('red',c(50,20,1)),list('snv',''),list('sder',c(1,4,w)))
sp$xp=pre(sp$x,p)
# segm <- segmkf(n = nrow(sp), K = 5)
segm <- list(rep1 = as.list(1:nrow(sp)))
fmc = gcvlv(snv(sp$xp), sp$SLA,segm,score = r2, fun = plskern, nlv = 1:ncomp, verb = F)
fmc$val$y1
segm <- segmkf(n = nrow(sp), K = 5)
# segm <- list(rep1 = as.list(1:nrow(sp)))
fmc = gcvlv(snv(sp$xp), sp$SLA,segm,score = r2, fun = plskern, nlv = 1:ncomp, verb = F)
fmc$val$y1
fm1=fmc$y[fmc$y$nlv==4,]
plot(fm1$yp,fm1$yref)
rmsep(fm1$yp,fm1$yref)
r2(fm1$yp,fm1$yref)
source("~/Documents/INRA/R/nirsextra/R/gridcv_mec.R")
# segm <- list(rep1 = as.list(1:nrow(sp)))
fmc = gcvlv(snv(sp$xp), sp$SLA,segm,score = r2, fun = plskern, nlv = 1:ncomp, verb = F)
str(zres[[1]])
source("~/Documents/INRA/R/nirsextra/R/gridcv_mec.R")
source("~/Documents/INRA/R/nirsextra/R/gridscore_mec.R", echo = TRUE)
source("~/Documents/INRA/R/nirsextra/R/gridscore_mec.R", echo = TRUE)
# segm <- list(rep1 = as.list(1:nrow(sp)))
fmc = gcvlv(snv(sp$xp), sp$SLA,segm,score = r2, fun = plskern, nlv = 1:ncomp, verb = F)
library(tidyverse)
library(dplyr)
# segm <- list(rep1 = as.list(1:nrow(sp)))
fmc = gcvlv(snv(sp$xp), sp$SLA,segm,score = r2, fun = plskern, nlv = 1:ncomp, verb = F)
source("~/Documents/INRA/R/nirsextra/R/gridscore_mec.R")
library(data.table
)
source("~/Documents/INRA/R/nirsextra/R/gridscore_mec.R")
# segm <- list(rep1 = as.list(1:nrow(sp)))
fmc = gcvlv(snv(sp$xp), sp$SLA,segm,score = r2, fun = plskern, nlv = 1:ncomp, verb = F)
fmc$val$y1
mean(-0.002030990,0.28449070,-0.80347343, 0.099862712,-0.235883135)
source("~/Documents/INRA/R/nirsextra/R/gridcv_mec.R")
# segm <- list(rep1 = as.list(1:nrow(sp)))
fmc = gcvlv(snv(sp$xp), sp$SLA,segm,score = r2, fun = plskern, nlv = 1:ncomp, verb = F)
str(zres[[1]])
y_list <- lapply(zres, function(x) x$y)
str(y_list)
y <- do.call(rbind, y_list)
str(y)
zres = lapply(zres, `[[`, "res")
zres <- setDF(rbindlist(zres))
str(zres)
15*5
is.null(pars)
## Case where pars is empty
if(is.null(pars)) {
res_rep[[i]] <- cbind(rep = rep(i, nsegm * le_nlv),
segm = sort(rep(1:nsegm, le_nlv)), zres)
}
res_rep <- setDF(rbindlist(res_rep))
res_rep$y1
res <- aggregate(res_rep[, namy, drop = FALSE],
by = res_rep[, nampar, drop = FALSE], FUN = mean)
namy <- colnames(Y)
nampar <- c("nlv", names(pars))
res <- aggregate(res_rep[, namy, drop = FALSE],
by = res_rep[, nampar, drop = FALSE], FUN = mean)
res
mean(-0.036326448,0.002448862,0.243131515,-5.804245035)
5*15
mean(-0.884842071 ,0.243131515,-5.804245035 ,-0.861484380,-0.679206396)
res_rep
mean(-0.884842071 ,0.243131515,-5.804245035 ,-0.861484380,-0.679206396)
mean(c(-0.884842071 ,0.243131515,-5.804245035 ,-0.861484380,-0.679206396))
source("~/Documents/INRA/R/nirsextra/R/gridcv_mec.R")
# segm <- segmkf(n = nrow(sp), K = 5)
segm <- list(rep1 = as.list(1:nrow(sp)))
fmc = gcvlv(snv(sp$xp), sp$SLA,segm,score = r2, fun = plskern, nlv = 1:ncomp, verb = F)
fmc$val$y1
source("~/Documents/INRA/R/nirsextra/R/gridcv_mec.R")
source("~/Documents/INRA/R/nirsextra/R/gridscore_mec.R")
fmc = gcvlv(snv(sp$xp), sp$SLA,segm,score = r2, fun = plskern, nlv = 1:ncomp, verb = F)
fmc$val$y1
fm1=fmc$y[fmc$y$nlv==4,]
plot(fm1$yp,fm1$yref)
which(fm1$yp<50)
plotsp(sp$x[15,])
plotsp(sp$x)
load("/home/ecarnot/Documents/INRA/Projets/scoop/sp_SLA")
sp=sp[which(sp$SLA<2000) & which(sp$x[,1000]<0.9),]
str(sp)
plotsp(sp$x)
plot(sp$x[,1000])
load("/home/ecarnot/Documents/INRA/Projets/scoop/sp_SLA")
sp=sp[which(sp$SLA<2000 & sp$x[,1000]<0.9),]
plot(sp$x[,1000])
load("/home/ecarnot/Documents/INRA/Projets/scoop/sp_SLA")
sp=sp[which(sp$SLA<2000 & sp$x[,1000]<0.9),]
w=21
ncomp=15
p=rbind(list('adj',''),list('red',c(50,20,1)),list('snv',''),list('sder',c(1,4,w)))
sp$xp=pre(sp$x,p)
# segm <- segmkf(n = nrow(sp), K = 5)
segm <- list(rep1 = as.list(1:nrow(sp)))
fmc = gcvlv(snv(sp$xp), sp$SLA,segm,score = r2, fun = plskern, nlv = 1:ncomp, verb = F)
fmc$val$y1
fm1=fmc$y[fmc$y$nlv==4,]
fm1=fmc$y[fmc$y$nlv==4,]
plot(fm1$yp,fm1$yref)
which(fm1$yp<50)
plotsp(sp$x[15,])
sp$SLA[15]
hist(sp$SLA)
plotsp(sp$x[15,])
plotsp(sp$x)
plotsp(snv(sp$x))
load("/home/ecarnot/Documents/INRA/Projets/scoop/sp_SLA")
sp=sp[c(which(sp$SLA<2000 & sp$x[,1000]<0.9),15),]
w=21
ncomp=15
p=rbind(list('adj',''),list('red',c(50,20,1)),list('snv',''),list('sder',c(1,4,w)))
sp$xp=pre(sp$x,p)
# segm <- segmkf(n = nrow(sp), K = 5)
segm <- list(rep1 = as.list(1:nrow(sp)))
fmc = gcvlv(snv(sp$xp), sp$SLA,segm,score = r2, fun = plskern, nlv = 1:ncomp, verb = F)
fm1=fmc$y[fmc$y$nlv==4,]
plot(fm1$yp,fm1$yref)
source("~/Documents/INRA/SLA_Concetta.R", echo = TRUE)
plot(fm1$yp,fm1$yref)
plot(fm1$yp,fm1$yref)
str(fm1)
which(fm1$yp<50)
fm1$rowname[15]
rowname(sp)
rownames(sp)
source("~/Documents/INRA/SLA_Concetta.R", echo = TRUE)
which(fm1$yp<150)
fm1$yp
length(fm1$yp)
load("/home/ecarnot/Documents/INRA/Projets/scoop/sp_SLA")
nrow(sp)
sp=sp[c(which(sp$SLA<2000 & sp$x[,1000]<0.9),15),]
nrow(sp)
c(which(sp$SLA<2000 & sp$x[,1000]<0.9),15)
sp=sp[-c(which(sp$SLA>2000 | sp$x[,1000]>0.9),15),]
load("/home/ecarnot/Documents/INRA/Projets/scoop/sp_SLA")
sp=sp[-c(which(sp$SLA>2000 | sp$x[,1000]>0.9),15),]
nrow(sp)
source("~/Documents/INRA/SLA_Concetta.R", echo = TRUE)
source("~/Documents/INRA/SLA_Concetta.R", echo = TRUE)
fmc$val$y1
# segm <- list(rep1 = as.list(1:nrow(sp)))
fmc = gcvlv(snv(sp$xp), sp$SLA,segm,score = cor2, fun = plskern, nlv = 1:ncomp, verb = F)
fmc$val$y1
plotsp(sp$x)
plotsp(sp$xp)
source("~/Documents/INRA/SLA_Concetta.R", echo = TRUE)
plot(fm1$yp,fm1$yref)
fm1=fmc$y[fmc$y$nlv==7,]
plot(fm1$yp,fm1$yref)
which(fm1$yp<100)
fm1$rowname[111]
fm1
source("~/Documents/INRA/SLA_Concetta.R", echo = TRUE)
which(fm1$yp<100)
fm1$rowname[85]
source("~/Documents/INRA/SLA_Concetta.R", echo = TRUE)
source("~/Documents/INRA/SLA_Concetta.R", echo = TRUE)
fm1
source("~/Documents/INRA/SLA_Concetta.R", echo = TRUE)
source("~/Documents/INRA/SLA_Concetta.R", echo = TRUE)
which(fm1$yp<150)
which(fm1$yp<160)
source("~/Documents/INRA/SLA_Concetta.R", echo = TRUE)
load("/home/ecarnot/Documents/INRA/Projets/scoop/sp_SLA")
which(sp$SLA>2000)
source("~/Documents/INRA/SLA_Concetta.R", echo = TRUE)
which(fm1$yp<160)
c(which(sp$SLA>2000),15,19,20)
load("/home/ecarnot/Documents/INRA/Projets/scoop/sp_SLA")
c(which(sp$SLA>2000),15,19,20)
source("~/Documents/INRA/SLA_Concetta.R", echo = TRUE)
which(fm1$yp<100)
load("/home/ecarnot/Documents/INRA/Projets/scoop/sp_SLA")
str(sp)
fm1$rowname[85]
source("~/Documents/INRA/SLA_Concetta.R", echo = TRUE)
source("~/Documents/INRA/SLA_Concetta.R", echo = TRUE)
source("~/Documents/INRA/SLA_Concetta.R", echo = TRUE)
which(fm1$yp>500)
source("~/Documents/INRA/SLA_Concetta.R", echo = TRUE)
source("~/Documents/INRA/SLA_Concetta.R", echo = TRUE)
which(fm1$yp>400)
source("~/Documents/INRA/SLA_Concetta.R", echo = TRUE)
source("~/Documents/INRA/SLA_Concetta.R", echo = TRUE)
which(fm1$yp<100)
source("~/Documents/INRA/SLA_Concetta.R", echo = TRUE)
source("~/Documents/INRA/SLA_Concetta.R", echo = TRUE)
fmc$val$y1
fmc$val$y1
mser(fmc)$cor2
source("~/Documents/INRA/SLA_Concetta.R", echo = TRUE)
source("~/Documents/INRA/SLA_Concetta.R", echo = TRUE)
source("~/Documents/INRA/SLA_Concetta.R", echo = TRUE)
source("~/Documents/INRA/SLA_Concetta.R", echo = TRUE)
fm1=fmc$y[fmc$y$nlv==15,]
plotsp(sp$xp)
source("~/Documents/INRA/SLA_Concetta.R", echo = TRUE)
source("~/Documents/INRA/SLA_Concetta.R", echo = TRUE)
plot(fm1$yp,fm1$yref, xlab="Teneur Prédite par SPIR", ylab="Teneur Mesurée")
library(nirsextra)
library(rchemo)
load("/home/ecarnot/Documents/INRA/Projets/scoop/sp_SLA")
# sp=sp[-c(which(sp$SLA>2000 | sp$x[,1000]>0.9),15),]
sp=sp[-c(14,15,19,20,30,47,88,which(sp$SLA>2000)),]
w=21
ncomp=25
p=rbind(list('adj',''),list('red',c(20,200,1)),list('snv',''),list('sder',c(1,4,w)))
# p=rbind(list('adj',''),list('red',c(50,20,1)),list('snv',''))
sp$xp=pre(sp$x,p)
# segm <- segmkf(n = nrow(sp), K = 5)
segm <- list(rep1 = as.list(1:nrow(sp)))
fmc = gcvlv(sp$xp, sp$SLA,segm,score = cor2, fun = plskern, nlv = 1:ncomp, verb = F)
mser(fmc)$cor2
fm1=fmc$y[fmc$y$nlv==15,]
plot(fm1$yp,fm1$yref, xlab="Teneur Prédite par SPIR", ylab="Teneur Mesurée")
abline(a = 0, b = 1, col = "red", lty = 2)
fit <- lm(fm1$yp ~ fm1$yref), abline(fit, col = "blue"), summary_fit <- summary(fit)
fit <- lm(fm1$yp ~ fm1$yref); abline(fit, col = "blue"); summary_fit <- summary(fit)
legend("topleft", legend = c("y = x", bquote(Validation_Croisée: ~ R^2 == .(round(r_squared, 2))),bquote(ncomp : .(best_pre_lo[[1]])),bquote(n_ech : .(length(fm1$yref)))), col = c("red", "blue", "white", "white", "white"),lty = c(2, 1),bty = "n")
fit <- lm(fm1$yp ~ fm1$yref); abline(fit, col = "blue"); summary_fit <- summary(fit); r_squared <- summary_fit$r.squared
legend("topleft", legend = c("y = x", bquote(Validation_Croisée: ~ R^2 == .(round(r_squared, 2))),bquote(ncomp : .(best_pre_lo[[1]])),bquote(n_ech : .(length(fm1$yref)))), col = c("red", "blue", "white", "white", "white"),lty = c(2, 1),bty = "n")
legend("topleft", legend = c("y = x", bquote(Validation_Croisée: ~ R^2 == .(round(r_squared, 2))),bquote(ncomp : .(best_nc)),bquote(n_ech : .(length(fm1$yref)))), col = c("red", "blue", "white", "white", "white"),lty = c(2, 1),bty = "n")
best_nc=15
fm1=fmc$y[fmc$y$nlv==best_nc,]
plot(fm1$yp,fm1$yref, xlab="Teneur Prédite par SPIR", ylab="Teneur Mesurée")
abline(a = 0, b = 1, col = "red", lty = 2)
fit <- lm(fm1$yp ~ fm1$yref); abline(fit, col = "blue"); summary_fit <- summary(fit); r_squared <- summary_fit$r.squared
legend("topleft", legend = c("y = x", bquote(Validation_Croisée: ~ R^2 == .(round(r_squared, 2))),bquote(ncomp : .(best_nc)),bquote(n_ech : .(length(fm1$yref)))), col = c("red", "blue", "white", "white", "white"),lty = c(2, 1),bty = "n")
source("~/Documents/INRA/SLA_Concetta.R", echo = TRUE)
source("~/Documents/INRA/SLA_Concetta.R", echo = TRUE)
source("~/Documents/INRA/SLA_Concetta.R", echo = TRUE)
str(sp)
S=sp[,c(1,3:13)]
S
gc()
source("~/Documents/INRA/SLA_Concetta.R", echo = TRUE)
fmc = gcvlv(sp$xp, sp$SLA,segm,score = cor2, fun = plskern, nlv = 1:ncomp, verb = F)
str(fmc)
116*20
mser(fmc)$cor2
?mser
source("~/Documents/INRA/SLA_Concetta.R", echo = TRUE)
str(fmc)
best_nc=15
fm1=fmc$y[fmc$y$nlv==best_nc,]
plot(fm1$yp,fm1$yref, xlab="Teneur Prédite par SPIR", ylab="Teneur Mesurée")
abline(a = 0, b = 1, col = "red", lty = 2)
fit <- lm(fm1$yp ~ fm1$yref); abline(fit, col = "blue"); summary_fit <- summary(fit); r_squared <- summary_fit$r.squared
legend("topleft", legend = c("y = x", bquote(Validation_Croisée: ~ R^2 == .(round(r_squared, 2))),bquote(ncomp : .(best_nc)),bquote(n_ech : .(length(fm1$yref)))), col = c("red", "blue", "white", "white", "white"),lty = c(2, 1),bty = "n")
which(fm1$yp<0)
source("~/Documents/INRA/SLA_Concetta.R", echo = TRUE)
which(fm1$yp<100)
source("~/Documents/INRA/SLA_Concetta.R", echo = TRUE)
which(fm1$yp<100)
source("~/Documents/INRA/SLA_Concetta.R", echo = TRUE)
source("~/Documents/INRA/SLA_Concetta.R", echo = TRUE)
plotsp(sp$x)
plotsp(sp$xm)
plotsp(sp$xp)
load("/home/ecarnot/Documents/INRA/Projets/scoop/sp_SLA")
str(sp)
plotsp(sp$x[100,])
plotsp(sp$x[10,])
plotsp(sp$x[100,])
plotsp(sp$x[200,])
plotsp(sp$x[20,])
plotsp(sp$x[30,])
plotsp(sp$x[40,])
plotsp(sp$x[50,])
plotsp(sp$x[60,])
plotsp(sp$x[10,])
sp$Group.1[10]
