#load up the struct tm object.
result$spectrumheaderwhensec <- readBin(fi, integer(),1,2)
result$spectrumheaderwhenmin <- readBin(fi, integer(),1,2)
result$spectrumheaderwhenhour <- readBin(fi, integer(),1,2)
result$spectrumheaderwhenmday <- readBin(fi, integer(),1,2)
result$spectrumheaderwhenmon <- readBin(fi, integer(),1,2)
result$spectrumheaderwhenyear <- readBin(fi, integer(),1,2)+1900
result$spectrumheaderwhenwday <- readBin(fi, integer(),1,2)
result$spectrumheaderwhenyday <- readBin(fi, integer(),1,2)
result$spectrumheaderwhenisdst <- readBin(fi, integer(),1,2)
#load up the file parameters.
result$spectrumheaderprogram_version <- as.numeric(readBin(fi,"raw",1,1))
result$spectrumheaderfile_version <- as.numeric(readBin(fi,"raw",1,1))
result$spectrumheaderitime <- as.numeric(readBin(fi,"raw",1,1))
result$spectrumheaderdc_corr <- as.numeric(readBin(fi,"raw",1,1))
result$spectrumheaderdc_time <- readBin(fi, integer(),1,4)
result$spectrumheaderdata_type <- as.numeric(readBin(fi,"raw",1,1))
result$spectrumheaderref_time <- readBin(fi, integer(),1,4)
result$spectrumheaderch1_wavel <- readBin(fi, numeric(),1,4)
result$spectrumheaderwavel_step <- readBin(fi, numeric(),1,4)
result$spectrumheaderdata_format <- as.numeric(readBin(fi,"raw",1,1))
result$spectrumheaderold_dc_count <- as.numeric(readBin(fi,"raw",1,1))
result$spectrumheaderold_ref_count <- as.numeric(readBin(fi,"raw",1,1))
result$spectrumheaderold_sample_count <- as.numeric(readBin(fi,"raw",1,1))
result$spectrumheaderapplication <- as.numeric(readBin(fi,"raw",1,1))
result$spectrumheaderwchannels <- readBin(fi, integer(),1,2)
#load up the app_data
result$spectrumheaderapp_data <- readBin(fi, what = character(), size = 128, endian = "little") #readChar(fi,128,useBytes=TRUE)  #rawToChar(readBin(fi,"raw",128))
seek(fi,where = 178)
#load up the GPS data.  NOTE: not used!
result$spectrumheadergps_data <- readBin(fi, what = character(), size = 56, endian = "little") #readChar(fi,56,useBytes=TRUE)  #rawToChar(readBin(fi,"raw",56))
seek(fi,where = 234)
#load up more header fields.
result$spectrumheaderit <- readBin(fi, integer(),1,4)
result$spectrumheaderfo <- readBin(fi, integer(),1,2)
result$spectrumheaderdcc <- readBin(fi, integer(),1,2)
result$spectrumheadercalibration <- readBin(fi, integer(),1,2)
result$spectrumheaderinstrument_num <- readBin(fi, integer(),1,2)
result$spectrumheaderymin <- readBin(fi, numeric(),1,4)
result$spectrumheaderymax <- readBin(fi, numeric(),1,4)
result$spectrumheaderxmin <- readBin(fi, numeric(),1,4)
result$spectrumheaderxmax <- readBin(fi, numeric(),1,4)
result$spectrumheaderip_numbits <- readBin(fi, integer(),1,2)
result$spectrumheaderxmode <- as.numeric(readBin(fi,"raw",1,1))
result$spectrumheaderflags <- paste(as.character(readBin(fi,"raw",4)),collapse=" ")  #readChar(fi,4,useBytes=TRUE)   rawToChar(readBin(fi,"raw",4))
result$spectrumheaderdc_count <- readBin(fi, integer(),1,2)
result$spectrumheaderref_count <- readBin(fi, integer(),1,2)
result$spectrumheadersample_count <- readBin(fi, integer(),1,2)
result$spectrumheaderinstrument <- as.numeric(readBin(fi,"raw",1,1)) #readChar(fi,1,useBytes=TRUE)  #rawToChar(readBin(fi,"raw",1))
result$spectrumheaderbulb <- readBin(fi, integer(),1,4)
result$spectrumheaderswir1_gain <- readBin(fi, integer(),1,2)
result$spectrumheaderswir2_gain <- readBin(fi, integer(),1,2)
result$spectrumheaderswir1_offset <- readBin(fi, integer(),1,2)
result$spectrumheaderswir2_offset <- readBin(fi, integer(),1,2)
result$spectrumheadersplice1_wavelength <- readBin(fi, numeric(),1,4)
result$spectrumheadersplice2_wavelength <- readBin(fi, numeric(),1,4)
# result$spectrumheaderwhen_in_ms <- readBin(fi, what = character(), size = 12, endian = "little") #
readChar(fi,12,useBytes=TRUE)  #rawToChar(readBin(fi,"raw",12))
# seek(fi,where = 308)
# result$spectrumheaderspare <- readBin(fi, what = character(), size = 20, endian = "little") #
readChar(fi,20,useBytes=TRUE)  #rawToChar(readBin(fi,"raw",20))
# seek(fi,where = 328)
#########################################################
# load up the spectrum.
#spectrum <- readBin(fi, double(),result$spectrumheaderwchannels)
spectrum <- t(readBin(fi, double(),result$spectrumheaderwchannels))
str(spectrum)
seek(fi,where = 0)
#result <- data.frame(spectrumheaderco=readChar(fi,3,useBytes=TRUE))
result$spectrumheaderco <- readChar(fi,3,useBytes=TRUE)
# result$spectrumheadercomments <- readBin(fi, what = character(), size = 157, endian = "little") #
result$spectrumheadercomments <-readChar(fi,157,useBytes=TRUE) # rawToChar(readBin(fi,"raw",157))
#load up the struct tm object.
result$spectrumheaderwhensec <- readBin(fi, integer(),1,2)
result$spectrumheaderwhenmin <- readBin(fi, integer(),1,2)
result$spectrumheaderwhenhour <- readBin(fi, integer(),1,2)
result$spectrumheaderwhenmday <- readBin(fi, integer(),1,2)
result$spectrumheaderwhenmon <- readBin(fi, integer(),1,2)
result$spectrumheaderwhenyear <- readBin(fi, integer(),1,2)+1900
result$spectrumheaderwhenwday <- readBin(fi, integer(),1,2)
result$spectrumheaderwhenyday <- readBin(fi, integer(),1,2)
result$spectrumheaderwhenisdst <- readBin(fi, integer(),1,2)
#load up the file parameters.
result$spectrumheaderprogram_version <- as.numeric(readBin(fi,"raw",1,1))
result$spectrumheaderfile_version <- as.numeric(readBin(fi,"raw",1,1))
result$spectrumheaderitime <- as.numeric(readBin(fi,"raw",1,1))
result$spectrumheaderdc_corr <- as.numeric(readBin(fi,"raw",1,1))
result$spectrumheaderdc_time <- readBin(fi, integer(),1,4)
result$spectrumheaderdata_type <- as.numeric(readBin(fi,"raw",1,1))
result$spectrumheaderref_time <- readBin(fi, integer(),1,4)
result$spectrumheaderch1_wavel <- readBin(fi, numeric(),1,4)
result$spectrumheaderwavel_step <- readBin(fi, numeric(),1,4)
result$spectrumheaderdata_format <- as.numeric(readBin(fi,"raw",1,1))
result$spectrumheaderold_dc_count <- as.numeric(readBin(fi,"raw",1,1))
result$spectrumheaderold_ref_count <- as.numeric(readBin(fi,"raw",1,1))
result$spectrumheaderold_sample_count <- as.numeric(readBin(fi,"raw",1,1))
result$spectrumheaderapplication <- as.numeric(readBin(fi,"raw",1,1))
result$spectrumheaderwchannels <- readBin(fi, integer(),1,2)
#load up the app_data
result$spectrumheaderapp_data <- readBin(fi, what = character(), size = 128, endian = "little") #readChar(fi,128,useBytes=TRUE)  #rawToChar(readBin(fi,"raw",128))
seek(fi,where = 178)
#load up the GPS data.  NOTE: not used!
result$spectrumheadergps_data <- readBin(fi, what = character(), size = 56, endian = "little") #readChar(fi,56,useBytes=TRUE)  #rawToChar(readBin(fi,"raw",56))
seek(fi,where = 234)
#load up more header fields.
result$spectrumheaderit <- readBin(fi, integer(),1,4)
result$spectrumheaderfo <- readBin(fi, integer(),1,2)
result$spectrumheaderdcc <- readBin(fi, integer(),1,2)
result$spectrumheadercalibration <- readBin(fi, integer(),1,2)
result$spectrumheaderinstrument_num <- readBin(fi, integer(),1,2)
result$spectrumheaderymin <- readBin(fi, numeric(),1,4)
result$spectrumheaderymax <- readBin(fi, numeric(),1,4)
result$spectrumheaderxmin <- readBin(fi, numeric(),1,4)
result$spectrumheaderxmax <- readBin(fi, numeric(),1,4)
result$spectrumheaderip_numbits <- readBin(fi, integer(),1,2)
result$spectrumheaderxmode <- as.numeric(readBin(fi,"raw",1,1))
result$spectrumheaderflags <- paste(as.character(readBin(fi,"raw",4)),collapse=" ")  #readChar(fi,4,useBytes=TRUE)   rawToChar(readBin(fi,"raw",4))
result$spectrumheaderdc_count <- readBin(fi, integer(),1,2)
result$spectrumheaderref_count <- readBin(fi, integer(),1,2)
result$spectrumheadersample_count <- readBin(fi, integer(),1,2)
result$spectrumheaderinstrument <- as.numeric(readBin(fi,"raw",1,1)) #readChar(fi,1,useBytes=TRUE)  #rawToChar(readBin(fi,"raw",1))
result$spectrumheaderbulb <- readBin(fi, integer(),1,4)
result$spectrumheaderswir1_gain <- readBin(fi, integer(),1,2)
result$spectrumheaderswir2_gain <- readBin(fi, integer(),1,2)
result$spectrumheaderswir1_offset <- readBin(fi, integer(),1,2)
result$spectrumheaderswir2_offset <- readBin(fi, integer(),1,2)
result$spectrumheadersplice1_wavelength <- readBin(fi, numeric(),1,4)
result$spectrumheadersplice2_wavelength <- readBin(fi, numeric(),1,4)
# result$spectrumheaderwhen_in_ms <- readBin(fi, what = character(), size = 12, endian = "little") #
readChar(fi,12,useBytes=TRUE)  #rawToChar(readBin(fi,"raw",12))
# seek(fi,where = 308)
# result$spectrumheaderspare <- readBin(fi, what = character(), size = 20, endian = "little") #
readChar(fi,20,useBytes=TRUE)  #rawToChar(readBin(fi,"raw",20))
# seek(fi,where = 328)
#########################################################
# load up the spectrum.
#spectrum <- readBin(fi, double(),result$spectrumheaderwchannels)
spectrum <- t(readBin(fi, double(),result$spectrumheaderwchannels))
str(spectrum)
plot(spectrum)
plot(t(spectrum))
plot(spectrum)
matplot(spectrum)
library(rnirs)
plosp(spectrum)
plotsp(spectrum)
spectrum
spectrum[1:10]
spectrum[1:100]
seek(fi,where = 0)
#result <- data.frame(spectrumheaderco=readChar(fi,3,useBytes=TRUE))
result$spectrumheaderco <- readChar(fi,3,useBytes=TRUE)
# result$spectrumheadercomments <- readBin(fi, what = character(), size = 157, endian = "little") #
result$spectrumheadercomments <-readChar(fi,157,useBytes=TRUE) # rawToChar(readBin(fi,"raw",157))
#load up the struct tm object.
result$spectrumheaderwhensec <- readBin(fi, integer(),1,2)
result$spectrumheaderwhenmin <- readBin(fi, integer(),1,2)
result$spectrumheaderwhenhour <- readBin(fi, integer(),1,2)
result$spectrumheaderwhenmday <- readBin(fi, integer(),1,2)
result$spectrumheaderwhenmon <- readBin(fi, integer(),1,2)
result$spectrumheaderwhenyear <- readBin(fi, integer(),1,2)+1900
result$spectrumheaderwhenwday <- readBin(fi, integer(),1,2)
result$spectrumheaderwhenyday <- readBin(fi, integer(),1,2)
result$spectrumheaderwhenisdst <- readBin(fi, integer(),1,2)
#load up the file parameters.
result$spectrumheaderprogram_version <- as.numeric(readBin(fi,"raw",1,1))
result$spectrumheaderfile_version <- as.numeric(readBin(fi,"raw",1,1))
result$spectrumheaderitime <- as.numeric(readBin(fi,"raw",1,1))
result$spectrumheaderdc_corr <- as.numeric(readBin(fi,"raw",1,1))
result$spectrumheaderdc_time <- readBin(fi, integer(),1,4)
result$spectrumheaderdata_type <- as.numeric(readBin(fi,"raw",1,1))
result$spectrumheaderref_time <- readBin(fi, integer(),1,4)
result$spectrumheaderch1_wavel <- readBin(fi, numeric(),1,4)
result$spectrumheaderwavel_step <- readBin(fi, numeric(),1,4)
result$spectrumheaderdata_format <- as.numeric(readBin(fi,"raw",1,1))
result$spectrumheaderold_dc_count <- as.numeric(readBin(fi,"raw",1,1))
result$spectrumheaderold_ref_count <- as.numeric(readBin(fi,"raw",1,1))
result$spectrumheaderold_sample_count <- as.numeric(readBin(fi,"raw",1,1))
result$spectrumheaderapplication <- as.numeric(readBin(fi,"raw",1,1))
result$spectrumheaderwchannels <- readBin(fi, integer(),1,2)
#load up the app_data
# result$spectrumheaderapp_data <- readBin(fi, what = character(), size = 128, endian = "little") #readChar(fi,128,useBytes=TRUE)  #rawToChar(readBin(fi,"raw",128))
# seek(fi,where = 178)
result$spectrumheaderapp_data <- readChar(fi,128,useBytes=TRUE)
#load up the GPS data.  NOTE: not used!
# result$spectrumheadergps_data <- readBin(fi, what = character(), size = 56, endian = "little") #readChar(fi,56,useBytes=TRUE)  #rawToChar(readBin(fi,"raw",56))
# seek(fi,where = 234)
result$spectrumheadergps_data <-readChar(fi,56,useBytes=TRUE)
#load up more header fields.
result$spectrumheaderit <- readBin(fi, integer(),1,4)
result$spectrumheaderfo <- readBin(fi, integer(),1,2)
result$spectrumheaderdcc <- readBin(fi, integer(),1,2)
result$spectrumheadercalibration <- readBin(fi, integer(),1,2)
result$spectrumheaderinstrument_num <- readBin(fi, integer(),1,2)
result$spectrumheaderymin <- readBin(fi, numeric(),1,4)
result$spectrumheaderymax <- readBin(fi, numeric(),1,4)
result$spectrumheaderxmin <- readBin(fi, numeric(),1,4)
result$spectrumheaderxmax <- readBin(fi, numeric(),1,4)
result$spectrumheaderip_numbits <- readBin(fi, integer(),1,2)
result$spectrumheaderxmode <- as.numeric(readBin(fi,"raw",1,1))
result$spectrumheaderflags <- paste(as.character(readBin(fi,"raw",4)),collapse=" ")  #readChar(fi,4,useBytes=TRUE)   rawToChar(readBin(fi,"raw",4))
result$spectrumheaderdc_count <- readBin(fi, integer(),1,2)
result$spectrumheaderref_count <- readBin(fi, integer(),1,2)
result$spectrumheadersample_count <- readBin(fi, integer(),1,2)
result$spectrumheaderinstrument <- as.numeric(readBin(fi,"raw",1,1)) #readChar(fi,1,useBytes=TRUE)  #rawToChar(readBin(fi,"raw",1))
result$spectrumheaderbulb <- readBin(fi, integer(),1,4)
result$spectrumheaderswir1_gain <- readBin(fi, integer(),1,2)
result$spectrumheaderswir2_gain <- readBin(fi, integer(),1,2)
result$spectrumheaderswir1_offset <- readBin(fi, integer(),1,2)
result$spectrumheaderswir2_offset <- readBin(fi, integer(),1,2)
result$spectrumheadersplice1_wavelength <- readBin(fi, numeric(),1,4)
result$spectrumheadersplice2_wavelength <- readBin(fi, numeric(),1,4)
# result$spectrumheaderwhen_in_ms <- readBin(fi, what = character(), size = 12, endian = "little") #
result$spectrumheaderwhen_in_ms <-readChar(fi,12,useBytes=TRUE)  #rawToChar(readBin(fi,"raw",12))
# seek(fi,where = 308)
# result$spectrumheaderspare <- readBin(fi, what = character(), size = 20, endian = "little") #
result$spectrumheaderspare <-readChar(fi,20,useBytes=TRUE)  #rawToChar(readBin(fi,"raw",20))
# seek(fi,where = 328)
#########################################################
# load up the spectrum.
#spectrum <- readBin(fi, double(),result$spectrumheaderwchannels)
spectrum <- t(readBin(fi, double(),result$spectrumheaderwchannels))
str(spectrum)
seek(fi,where = 0)
# Tous les noms sont sans majuscules et sans point car postgresql a du mal avec.
#result <- data.frame(spectrumheaderco=readChar(fi,3,useBytes=TRUE))
result$spectrumheaderco <- readChar(fi,3,useBytes=TRUE)
# result$spectrumheadercomments <- readBin(fi, what = character(), size = 157, endian = "little") #
result$spectrumheadercomments <-readChar(fi,157,useBytes=TRUE) # rawToChar(readBin(fi,"raw",157))
seek(fi,where = NA)
#load up the struct tm object.
result$spectrumheaderwhensec <- readBin(fi, integer(),1,2)
result$spectrumheaderwhenmin <- readBin(fi, integer(),1,2)
result$spectrumheaderwhenhour <- readBin(fi, integer(),1,2)
result$spectrumheaderwhenmday <- readBin(fi, integer(),1,2)
result$spectrumheaderwhenmon <- readBin(fi, integer(),1,2)
result$spectrumheaderwhenyear <- readBin(fi, integer(),1,2)+1900
result$spectrumheaderwhenwday <- readBin(fi, integer(),1,2)
result$spectrumheaderwhenyday <- readBin(fi, integer(),1,2)
result$spectrumheaderwhenisdst <- readBin(fi, integer(),1,2)
#load up the file parameters.
result$spectrumheaderprogram_version <- as.numeric(readBin(fi,"raw",1,1))
result$spectrumheaderfile_version <- as.numeric(readBin(fi,"raw",1,1))
result$spectrumheaderitime <- as.numeric(readBin(fi,"raw",1,1))
result$spectrumheaderdc_corr <- as.numeric(readBin(fi,"raw",1,1))
result$spectrumheaderdc_time <- readBin(fi, integer(),1,4)
result$spectrumheaderdata_type <- as.numeric(readBin(fi,"raw",1,1))
result$spectrumheaderref_time <- readBin(fi, integer(),1,4)
result$spectrumheaderch1_wavel <- readBin(fi, numeric(),1,4)
result$spectrumheaderwavel_step <- readBin(fi, numeric(),1,4)
result$spectrumheaderdata_format <- as.numeric(readBin(fi,"raw",1,1))
result$spectrumheaderold_dc_count <- as.numeric(readBin(fi,"raw",1,1))
result$spectrumheaderold_ref_count <- as.numeric(readBin(fi,"raw",1,1))
result$spectrumheaderold_sample_count <- as.numeric(readBin(fi,"raw",1,1))
result$spectrumheaderapplication <- as.numeric(readBin(fi,"raw",1,1))
result$spectrumheaderwchannels <- readBin(fi, integer(),1,2)
#load up the app_data
# result$spectrumheaderapp_data <- readBin(fi, what = character(), size = 128, endian = "little") #readChar(fi,128,useBytes=TRUE)  #rawToChar(readBin(fi,"raw",128))
# seek(fi,where = 178)
result$spectrumheaderapp_data <- readChar(fi,128,useBytes=TRUE)
seek(fi,where = NA)
#load up the GPS data.  NOTE: not used!
# result$spectrumheadergps_data <- readBin(fi, what = character(), size = 56, endian = "little") #readChar(fi,56,useBytes=TRUE)  #rawToChar(readBin(fi,"raw",56))
# seek(fi,where = 234)
result$spectrumheadergps_data <-readChar(fi,56,useBytes=TRUE)
seek(fi,where = NA)
#load up more header fields.
result$spectrumheaderit <- readBin(fi, integer(),1,4)
result$spectrumheaderfo <- readBin(fi, integer(),1,2)
result$spectrumheaderdcc <- readBin(fi, integer(),1,2)
result$spectrumheadercalibration <- readBin(fi, integer(),1,2)
result$spectrumheaderinstrument_num <- readBin(fi, integer(),1,2)
result$spectrumheaderymin <- readBin(fi, numeric(),1,4)
result$spectrumheaderymax <- readBin(fi, numeric(),1,4)
result$spectrumheaderxmin <- readBin(fi, numeric(),1,4)
result$spectrumheaderxmax <- readBin(fi, numeric(),1,4)
result$spectrumheaderip_numbits <- readBin(fi, integer(),1,2)
result$spectrumheaderxmode <- as.numeric(readBin(fi,"raw",1,1))
result$spectrumheaderflags <- paste(as.character(readBin(fi,"raw",4)),collapse=" ")  #readChar(fi,4,useBytes=TRUE)   rawToChar(readBin(fi,"raw",4))
result$spectrumheaderdc_count <- readBin(fi, integer(),1,2)
result$spectrumheaderref_count <- readBin(fi, integer(),1,2)
result$spectrumheadersample_count <- readBin(fi, integer(),1,2)
result$spectrumheaderinstrument <- as.numeric(readBin(fi,"raw",1,1)) #readChar(fi,1,useBytes=TRUE)  #rawToChar(readBin(fi,"raw",1))
result$spectrumheaderbulb <- readBin(fi, integer(),1,4)
result$spectrumheaderswir1_gain <- readBin(fi, integer(),1,2)
result$spectrumheaderswir2_gain <- readBin(fi, integer(),1,2)
result$spectrumheaderswir1_offset <- readBin(fi, integer(),1,2)
result$spectrumheaderswir2_offset <- readBin(fi, integer(),1,2)
result$spectrumheadersplice1_wavelength <- readBin(fi, numeric(),1,4)
result$spectrumheadersplice2_wavelength <- readBin(fi, numeric(),1,4)
# result$spectrumheaderwhen_in_ms <- readBin(fi, what = character(), size = 12, endian = "little") #
result$spectrumheaderwhen_in_ms <-readChar(fi,12,useBytes=TRUE)  #rawToChar(readBin(fi,"raw",12))
# seek(fi,where = 308)
seek(fi,where = NA)
# result$spectrumheaderspare <- readBin(fi, what = character(), size = 20, endian = "little") #
result$spectrumheaderspare <-readChar(fi,20,useBytes=TRUE)  #rawToChar(readBin(fi,"raw",20))
# seek(fi,where = 328)
seek(fi,where = NA)
#########################################################
# load up the spectrum.
#spectrum <- readBin(fi, double(),result$spectrumheaderwchannels)
spectrum <- t(readBin(fi, double(),result$spectrumheaderwchannels))
str(spectrum)
seek(fi,where = 0)
#result <- data.frame(spectrumheaderco=readChar(fi,3,useBytes=TRUE))
result$spectrumheaderco <- readChar(fi,3,useBytes=TRUE)
# result$spectrumheadercomments <- readBin(fi, what = character(), size = 157, endian = "little") #
result$spectrumheadercomments <-readChar(fi,157,useBytes=TRUE) # rawToChar(readBin(fi,"raw",157))
seek(fi,where = NA)
#load up the struct tm object.
result$spectrumheaderwhensec <- readBin(fi, integer(),1,2)
result$spectrumheaderwhenmin <- readBin(fi, integer(),1,2)
result$spectrumheaderwhenhour <- readBin(fi, integer(),1,2)
result$spectrumheaderwhenmday <- readBin(fi, integer(),1,2)
result$spectrumheaderwhenmon <- readBin(fi, integer(),1,2)
result$spectrumheaderwhenyear <- readBin(fi, integer(),1,2)+1900
result$spectrumheaderwhenwday <- readBin(fi, integer(),1,2)
result$spectrumheaderwhenyday <- readBin(fi, integer(),1,2)
result$spectrumheaderwhenisdst <- readBin(fi, integer(),1,2)
#load up the file parameters.
result$spectrumheaderprogram_version <- as.numeric(readBin(fi,"raw",1,1))
result$spectrumheaderfile_version <- as.numeric(readBin(fi,"raw",1,1))
result$spectrumheaderitime <- as.numeric(readBin(fi,"raw",1,1))
result$spectrumheaderdc_corr <- as.numeric(readBin(fi,"raw",1,1))
result$spectrumheaderdc_time <- readBin(fi, integer(),1,4)
result$spectrumheaderdata_type <- as.numeric(readBin(fi,"raw",1,1))
result$spectrumheaderref_time <- readBin(fi, integer(),1,4)
result$spectrumheaderch1_wavel <- readBin(fi, numeric(),1,4)
result$spectrumheaderwavel_step <- readBin(fi, numeric(),1,4)
result$spectrumheaderdata_format <- as.numeric(readBin(fi,"raw",1,1))
result$spectrumheaderold_dc_count <- as.numeric(readBin(fi,"raw",1,1))
result$spectrumheaderold_ref_count <- as.numeric(readBin(fi,"raw",1,1))
result$spectrumheaderold_sample_count <- as.numeric(readBin(fi,"raw",1,1))
result$spectrumheaderapplication <- as.numeric(readBin(fi,"raw",1,1))
result$spectrumheaderwchannels <- readBin(fi, integer(),1,2)
#load up the app_data
# result$spectrumheaderapp_data <- readBin(fi, what = character(), size = 128, endian = "little") #readChar(fi,128,useBytes=TRUE)  #rawToChar(readBin(fi,"raw",128))
# seek(fi,where = 178)
result$spectrumheaderapp_data <- readChar(fi,128,useBytes=TRUE)
seek(fi,where = NA)
#load up the GPS data.  NOTE: not used!
# result$spectrumheadergps_data <- readBin(fi, what = character(), size = 56, endian = "little") #readChar(fi,56,useBytes=TRUE)  #rawToChar(readBin(fi,"raw",56))
# seek(fi,where = 234)
result$spectrumheadergps_data <-readChar(fi,56,useBytes=TRUE)
seek(fi,where = NA)
#load up more header fields.
result$spectrumheaderit <- readBin(fi, integer(),1,4)
result$spectrumheaderfo <- readBin(fi, integer(),1,2)
result$spectrumheaderdcc <- readBin(fi, integer(),1,2)
result$spectrumheadercalibration <- readBin(fi, integer(),1,2)
result$spectrumheaderinstrument_num <- readBin(fi, integer(),1,2)
result$spectrumheaderymin <- readBin(fi, numeric(),1,4)
result$spectrumheaderymax <- readBin(fi, numeric(),1,4)
result$spectrumheaderxmin <- readBin(fi, numeric(),1,4)
result$spectrumheaderxmax <- readBin(fi, numeric(),1,4)
result$spectrumheaderip_numbits <- readBin(fi, integer(),1,2)
result$spectrumheaderxmode <- as.numeric(readBin(fi,"raw",1,1))
result$spectrumheaderflags <- paste(as.character(readBin(fi,"raw",4)),collapse=" ")  #readChar(fi,4,useBytes=TRUE)   rawToChar(readBin(fi,"raw",4))
result$spectrumheaderdc_count <- readBin(fi, integer(),1,2)
result$spectrumheaderref_count <- readBin(fi, integer(),1,2)
result$spectrumheadersample_count <- readBin(fi, integer(),1,2)
result$spectrumheaderinstrument <- as.numeric(readBin(fi,"raw",1,1)) #readChar(fi,1,useBytes=TRUE)  #rawToChar(readBin(fi,"raw",1))
result$spectrumheaderbulb <- readBin(fi, integer(),1,4)
result$spectrumheaderswir1_gain <- readBin(fi, integer(),1,2)
result$spectrumheaderswir2_gain <- readBin(fi, integer(),1,2)
result$spectrumheaderswir1_offset <- readBin(fi, integer(),1,2)
result$spectrumheaderswir2_offset <- readBin(fi, integer(),1,2)
result$spectrumheadersplice1_wavelength <- readBin(fi, numeric(),1,4)
result$spectrumheadersplice2_wavelength <- readBin(fi, numeric(),1,4)
# result$spectrumheaderwhen_in_ms <- readBin(fi, what = character(), size = 12, endian = "little") #
result$spectrumheaderwhen_in_ms <-readChar(fi,12,useBytes=TRUE)  #rawToChar(readBin(fi,"raw",12))
# seek(fi,where = 308)
seek(fi,where = NA)
# result$spectrumheaderspare <- readBin(fi, what = character(), size = 20, endian = "little") #
result$spectrumheaderspare <-readChar(fi,20,useBytes=TRUE)  #rawToChar(readBin(fi,"raw",20))
# seek(fi,where = 328)
seek(fi,where = NA)
#########################################################
# load up the spectrum.
#spectrum <- readBin(fi, double(),result$spectrumheaderwchannels)
spectrum <- t(readBin(fi, double(),result$spectrumheaderwchannels))
str(spectrum)
seek(fi,where = 0)
#result <- data.frame(spectrumheaderco=readChar(fi,3,useBytes=TRUE))
result$spectrumheaderco <- readChar(fi,3,useBytes=TRUE)
result$spectrumheadercomments <- readBin(fi, what = character(), size = 157, endian = "little") #
# result$spectrumheadercomments <-readChar(fi,157,useBytes=TRUE) # rawToChar(readBin(fi,"raw",157))
seek(fi,where = 160)
#load up the struct tm object.
result$spectrumheaderwhensec <- readBin(fi, integer(),1,2)
result$spectrumheaderwhenmin <- readBin(fi, integer(),1,2)
result$spectrumheaderwhenhour <- readBin(fi, integer(),1,2)
result$spectrumheaderwhenmday <- readBin(fi, integer(),1,2)
result$spectrumheaderwhenmon <- readBin(fi, integer(),1,2)
result$spectrumheaderwhenyear <- readBin(fi, integer(),1,2)+1900
result$spectrumheaderwhenwday <- readBin(fi, integer(),1,2)
result$spectrumheaderwhenyday <- readBin(fi, integer(),1,2)
result$spectrumheaderwhenisdst <- readBin(fi, integer(),1,2)
#load up the file parameters.
result$spectrumheaderprogram_version <- as.numeric(readBin(fi,"raw",1,1))
result$spectrumheaderfile_version <- as.numeric(readBin(fi,"raw",1,1))
result$spectrumheaderitime <- as.numeric(readBin(fi,"raw",1,1))
result$spectrumheaderdc_corr <- as.numeric(readBin(fi,"raw",1,1))
result$spectrumheaderdc_time <- readBin(fi, integer(),1,4)
result$spectrumheaderdata_type <- as.numeric(readBin(fi,"raw",1,1))
result$spectrumheaderref_time <- readBin(fi, integer(),1,4)
result$spectrumheaderch1_wavel <- readBin(fi, numeric(),1,4)
result$spectrumheaderwavel_step <- readBin(fi, numeric(),1,4)
result$spectrumheaderdata_format <- as.numeric(readBin(fi,"raw",1,1))
result$spectrumheaderold_dc_count <- as.numeric(readBin(fi,"raw",1,1))
result$spectrumheaderold_ref_count <- as.numeric(readBin(fi,"raw",1,1))
result$spectrumheaderold_sample_count <- as.numeric(readBin(fi,"raw",1,1))
result$spectrumheaderapplication <- as.numeric(readBin(fi,"raw",1,1))
result$spectrumheaderwchannels <- readBin(fi, integer(),1,2)
#load up the app_data
result$spectrumheaderapp_data <- readBin(fi, what = character(), size = 128, endian = "little") #readChar(fi,128,useBytes=TRUE)  #rawToChar(readBin(fi,"raw",128))
seek(fi,where = 334)
# result$spectrumheaderapp_data <- readChar(fi,128,useBytes=TRUE)
seek(fi,where = NA)
#load up the GPS data.  NOTE: not used!
result$spectrumheadergps_data <- readBin(fi, what = character(), size = 56, endian = "little") #readChar(fi,56,useBytes=TRUE)  #rawToChar(readBin(fi,"raw",56))
seek(fi,where = 390)
# result$spectrumheadergps_data <-readChar(fi,56,useBytes=TRUE)
seek(fi,where = NA)
#load up more header fields.
result$spectrumheaderit <- readBin(fi, integer(),1,4)
result$spectrumheaderfo <- readBin(fi, integer(),1,2)
result$spectrumheaderdcc <- readBin(fi, integer(),1,2)
result$spectrumheadercalibration <- readBin(fi, integer(),1,2)
result$spectrumheaderinstrument_num <- readBin(fi, integer(),1,2)
result$spectrumheaderymin <- readBin(fi, numeric(),1,4)
result$spectrumheaderymax <- readBin(fi, numeric(),1,4)
result$spectrumheaderxmin <- readBin(fi, numeric(),1,4)
result$spectrumheaderxmax <- readBin(fi, numeric(),1,4)
result$spectrumheaderip_numbits <- readBin(fi, integer(),1,2)
result$spectrumheaderxmode <- as.numeric(readBin(fi,"raw",1,1))
result$spectrumheaderflags <- paste(as.character(readBin(fi,"raw",4)),collapse=" ")  #readChar(fi,4,useBytes=TRUE)   rawToChar(readBin(fi,"raw",4))
result$spectrumheaderdc_count <- readBin(fi, integer(),1,2)
result$spectrumheaderref_count <- readBin(fi, integer(),1,2)
result$spectrumheadersample_count <- readBin(fi, integer(),1,2)
result$spectrumheaderinstrument <- as.numeric(readBin(fi,"raw",1,1)) #readChar(fi,1,useBytes=TRUE)  #rawToChar(readBin(fi,"raw",1))
result$spectrumheaderbulb <- readBin(fi, integer(),1,4)
result$spectrumheaderswir1_gain <- readBin(fi, integer(),1,2)
result$spectrumheaderswir2_gain <- readBin(fi, integer(),1,2)
result$spectrumheaderswir1_offset <- readBin(fi, integer(),1,2)
result$spectrumheaderswir2_offset <- readBin(fi, integer(),1,2)
result$spectrumheadersplice1_wavelength <- readBin(fi, numeric(),1,4)
result$spectrumheadersplice2_wavelength <- readBin(fi, numeric(),1,4)
result$spectrumheaderwhen_in_ms <- readBin(fi, what = character(), size = 12, endian = "little") #
# result$spectrumheaderwhen_in_ms <-readChar(fi,12,useBytes=TRUE)  #rawToChar(readBin(fi,"raw",12))
seek(fi,where = 464)
seek(fi,where = NA)
result$spectrumheaderspare <- readBin(fi, what = character(), size = 20, endian = "little") #
# result$spectrumheaderspare <-readChar(fi,20,useBytes=TRUE)  #rawToChar(readBin(fi,"raw",20))
seek(fi,where = 484)
seek(fi,where = NA)
#########################################################
# load up the spectrum.
#spectrum <- readBin(fi, double(),result$spectrumheaderwchannels)
spectrum <- t(readBin(fi, double(),result$spectrumheaderwchannels))
str(spectrum)
result$spectrumheadercomments
d="/run/user/1000/gvfs/smb-share:server=stocka2,share=agap-ble/Ble/ASD/MobiDiv_bacs20220318"
f=file.path(d,"1209_12200006.asd")
source('~/Documents/INRA/R/nirsextra/R/asd_read.R')
sp=asd_read(f)
})
sp=asd_read(f)
sp$info$spectrumheadercomments
result <- data.frame(id_spectres=1)
fi <- file(f, "rb")
#result <- data.frame(spectrumheaderco=readChar(fi,3,useBytes=TRUE))
result$spectrumheaderco <- readChar(fi,3,useBytes=TRUE)
result$spectrumheadercomments <- readBin(fi, what = character(), size = 157, endian = "little") #
result$spectrumheadercomments
seek(fi,where = 3)
seek(fi,where = 0)
#result <- data.frame(spectrumheaderco=readChar(fi,3,useBytes=TRUE))
result$spectrumheaderco <- readChar(fi,3,useBytes=TRUE)
result$spectrumheadercomments <-readChar(fi,157,useBytes=TRUE) # rawToChar(readBin(fi,"raw",157))
result$spectrumheadercomments
d="/run/user/1000/gvfs/smb-share:server=stocka2,share=agap-ble/Ble/ASD/OASIs_Bois_2022_InstRhod"
f=file.path(d,"InstRhod00001.asd")
close(fi)
result <- data.frame(id_spectres=1)
fi <- file(f, "rb")
#result <- data.frame(spectrumheaderco=readChar(fi,3,useBytes=TRUE))
result$spectrumheaderco <- readChar(fi,3,useBytes=TRUE)
result$spectrumheaderco
result$spectrumheadercomments <- readBin(fi, what = character(), size = 157, endian = "little") #
result$spectrumheadercomments
seek(fi,where = 0)
#result <- data.frame(spectrumheaderco=readChar(fi,3,useBytes=TRUE))
result$spectrumheaderco <- readChar(fi,3,useBytes=TRUE)
result$spectrumheadercomments <- readBin(fi, what = character(), size = 157, endian = "little")
result$spectrumheadercomments
seek(fi,where = NA)
close(fi)
source('~/Documents/INRA/R/nirsextra/R/asd_read.R')
f
sp=asd_read(f)
source('~/Documents/INRA/R/nirsextra/R/asd_read.R')
sp=asd_read(f)
plot(sp)
plot(sp$spectrum)
plot(sp$spectrum)
str(sp$spectrum)
plotsp(sp$spectrum)
sp=asd_read_dir(d)
source('~/Documents/INRA/R/nirsextra/R/asd_read_dir.R')
sp=asd_read_dir(d)
str(sp)
